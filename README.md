# –ü—Ä–∞–∫—Ç–∏–∫–∞ 5: –î–µ–ø–ª–æ–π–º–µ–Ω—Ç –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ MLflow

## üìä –û –ø—Ä–æ–µ–∫—Ç–µ

- **–î–∞—Ç–∞—Å–µ—Ç**: Wine (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç sklearn)
- **–ó–∞–¥–∞—á–∞**: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ 3 –∫–ª–∞—Å—Å–∞
- **–ú–æ–¥–µ–ª—å**: RandomForestClassifier
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: n_estimators=100, max_depth=5
- **–ú–µ—Ç—Ä–∏–∫–∏**: accuracy=1.0, f1_macro=1.0
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ**: 90% train, 10% test

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install mlflow scikit-learn pandas matplotlib flask requests
```

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python train_rf.py
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

```bash
python flask_server.py
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

```bash
python test_inference.py
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ train_rf.py          # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ flask_server.py      # Flask —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îú‚îÄ‚îÄ test_inference.py    # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
‚îú‚îÄ‚îÄ test_data.json       # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
‚îú‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ mlruns/              # MLflow —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
```

## üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (`train_rf.py`)

- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç Wine –∏–∑ sklearn
- –†–∞–∑–¥–µ–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ train/test (90%/10%)
- –û–±—É—á–∞–µ—Ç RandomForestClassifier
- –õ–æ–≥–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –º–µ—Ç—Ä–∏–∫–∏ –≤ MLflow
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

### Flask —Å–µ—Ä–≤–µ—Ä (`flask_server.py`)

- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –∏–∑ MLflow
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/invocations` –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/health` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (`test_inference.py`)

- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ API
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
- –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏

- **Accuracy**: 1.0 (100%)
- **F1-macro**: 1.0 (100%)

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON):**

```json
{
  "columns": ["alcohol", "malic_acid", "ash", ...],
  "data": [
    [13.88, 1.89, 2.59, ...],
    [12.86, 1.35, 2.32, ...]
  ]
}
```

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

```json
[0, 2, 2]
```

## üåê API Endpoints

### GET `/health`

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞

```bash
curl http://127.0.0.1:5000/health
```

### POST `/invocations`

–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π

```bash
curl -X POST http://127.0.0.1:5000/invocations \
     -H 'Content-Type: application/json' \
     -d @test_data.json
```

## üìà MLflow UI

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∑–∞–ø—É—Å—Ç–∏—Ç–µ MLflow UI:

```bash
mlflow ui
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞:

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
- –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
- –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (confusion matrix, classification report)
- –ú–æ–¥–µ–ª—å –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
import requests
import json

# –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
with open('test_data.json', 'r') as f:
    data = json.load(f)

# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ API
response = requests.post(
    'http://127.0.0.1:5000/invocations',
    headers={'Content-Type': 'application/json'},
    json=data
)

# –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
predictions = response.json()
print(f"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {predictions}")
```

## üìù –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- mlflow
- scikit-learn
- pandas
- matplotlib
- flask
- requests

## üéì –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–ª–∏

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

1. **MLOps –ø—Ä–∞–∫—Ç–∏–∫–∏**: –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ MLflow
2. **–î–µ–ø–ª–æ–π–º–µ–Ω—Ç**: —Å–æ–∑–¥–∞–Ω–∏–µ REST API –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞

## üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç—ã

![1761047291393](image/README/1761047291393.png)


![1761047352650](image/README/1761047352650.png)



![1761047386793](image/README/1761047386793.png)


![1761047398830](image/README/1761047398830.png)
